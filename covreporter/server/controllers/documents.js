displayFile("<div class=\"file\">\n  <h2 id=\"server/controllers/documents.js\"> server/controllers/documents.js</h2>\n  <div id=\"stats\">\n    <div class=\"linecoverage\">\n      <span class=\"linecov terrible\">\n        [67.57%]\n      </span>\n      <span>50/74<span>\n      <span class=\"misses\">\n        24\n      </span>\n    </div>\n    <div class=\"branchcoverage\">\n      <span class=\"branchcov terrible\">\n        [44.59%]\n      </span>\n      <span>33/74</span>\n      <span class=\"misses\">\n        41\n      </span>\n    </div>\n  </div>\n  <table id=\"source\">\n    <thead>\n      <tr>\n        <th>Line</th>\n        <th>Hits</th>\n        <th>Source</th>\n      </tr>\n    </thead>\n    <tbody>\n      \n      \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">1</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">(function() {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">2</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">  'use strict';</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">3</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">  var Document = require('../models/document'),</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">4</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    Role = require('../models/role'),</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">5</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    Type = require('../models/doc-type');</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">6</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">  var roles;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">7</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">  var jwt = require('jsonwebtoken');</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">8</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">  var secretKey = require('../../config/config').secret;</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">9</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">10</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">  module.exports = {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">11</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    create: function(req, res) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">12</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        var document = new Document();</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">13</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.ownerId = req.decoded._doc._id;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">14</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.owner = req.decoded._doc.username;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">15</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.title = req.body.title;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">16</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.content = req.body.content;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">17</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.dateCreated = new Date();</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">18</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.lastModified = Date.now();</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">19</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        document.accessType = req.body.accessType || \"None\";</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">20</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      // Get RoleId of the role assigned to the document</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">21</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">      Role.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">22</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        title: req.body.access || 'Viewer'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">23</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      }).exec(function(err, access) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">24</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">25</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">          res.status(500).send(<i class=\"cond-miss\">err.errormessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">26</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">27</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">          document.accessId = access[0]._id;</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">28</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">29</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          // Get TypeId of the role assigned to the document</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">30</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">          Type.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">31</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            type: req.body.type || 'General'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">32</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }).exec(function(err, type) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">33</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            if (err)</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">34</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              return res.status(500).send(<i class=\"cond-miss\">err.errormessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">35</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">            document.typeId = type[0]._id;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">36</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">            document.save(function(err, document) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">37</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              if (err)</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">38</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                return res.status(409).send({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">39</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  'error': err.errmessage || err,</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">40</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  'message': 'Document cannot be duplicate'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">41</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                });</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">42</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">              return res.status(200).json(document);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">43</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">44</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">45</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">46</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">47</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    },</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">48</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">49</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    session: function(req, res, next) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">50</td>\n              <td class=\"hits\">14</td>\n              <td class=\"source\">      var tokenOne = req.headers['x-access-token'];</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">51</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      if(tokenOne) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">52</td>\n              <td class=\"hits\">13</td>\n              <td class=\"source\">        jwt.verify(tokenOne, secretKey, function(err, decoded) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">53</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          if (!err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">54</td>\n              <td class=\"hits\">13</td>\n              <td class=\"source\">            req.decoded = decoded;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">55</td>\n              <td class=\"hits\">13</td>\n              <td class=\"source\">            next();</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">56</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">57</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            return res.status(401).send({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">58</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              message: 'Failed to Authenticate'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">59</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">60</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">61</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">62</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">63</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">        return res.status(401).send({message: 'You are not authenticated documents'});</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">64</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">65</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    },</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">66</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">67</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    find: function(req, res) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">68</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      // Users can only view documents available to their roles and are not private.</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">69</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      if (req.query.from) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">70</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">        Document.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">71</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          accessType: 'None',</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">72</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          accessId: req.decoded._doc.roleId,</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">73</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          dateCreated: {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">74</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            $gte: new Date(req.query.from),</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">75</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            $lt: new Date(req.query.to)</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">76</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">77</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }, function(err, documents) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">78</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">79</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">80</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else if (documents.length < 1) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">81</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            res.status(404).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">82</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              'message': 'No documents found'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">83</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">84</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">85</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">            res.status(200).json(documents);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">86</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">87</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">88</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      } else if (req.query.title) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">89</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        Document.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">90</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          accessType: 'None',</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">91</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          accessId: req.decoded._doc.roleId,</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">92</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          title: req.query.title</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">93</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }, function(err, documents) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">94</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">95</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">96</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else if (documents.length < 1) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">97</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">            res.status(404).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">98</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              'message': 'No documents found'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">99</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">100</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">101</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">            res.status(200).json(documents);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">102</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">103</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">104</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      } else if (req.query.role) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">105</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">        Role.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">106</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          title: req.query.role</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">107</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }).exec(function(err, role) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">108</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">109</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">110</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">111</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            if (role[0]._id != req.decoded._doc.roleId) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">112</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">              return res.status(401).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">113</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                'message': 'Sorry, you are not allowed to view documents with this role'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">114</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">115</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">116</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">              Document.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">117</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                accessType: 'None',</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">118</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                accessId: role[0]._id,</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">119</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              }, function(err, documents) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">120</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">121</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                  return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">122</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                } else if (documents.length < 1) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">123</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                  res.status(404).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">124</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                    'message': 'No documents found'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">125</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">126</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">127</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">                  res.status(200).json(documents);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">128</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">129</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">130</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">131</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">132</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">133</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">134</td>\n              <td class=\"hits\">3</td>\n              <td class=\"source\">        Document.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">135</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          accessType: 'None',</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">136</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          accessId: req.decoded._doc.roleId</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">137</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }).limit(req.query.limit).sort({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">138</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          dateCreated: -1</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">139</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }).exec(function(err, document) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">140</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">141</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">142</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">143</td>\n              <td class=\"hits\">3</td>\n              <td class=\"source\">            return res.status(200).json(document);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">144</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">145</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">146</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">147</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    },</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">148</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">149</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    findADoc: function(req, res) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">150</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">      Document.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">151</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        _id: req.params.document_id</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">152</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      }).exec(function(err, documents) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">153</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">        return res.status(200).json(documents);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">154</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">155</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    },</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">156</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">157</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    findByRole: function(req, res) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">158</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">      Document.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">159</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        accessId: req.params.access_id,</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">160</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        accessType: 'None'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">161</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      }, function(err, doc) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">162</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        if (<i class=\"cond-miss\">err</i>) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">163</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">          return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">164</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        } else if (<i class=\"cond-miss\"><i class=\"cond-miss\">doc</i> && <i class=\"cond-miss\">doc.length</i></i>) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">165</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">          return res.status(200).json(doc);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">166</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">167</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">          return res.status(404).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">168</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            'message': 'No documents found'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">169</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">170</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">171</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">172</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    },</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">173</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">174</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    delete: function(req, res) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">175</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">      Document.findById(req.params.document_id, function(err, doc) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">176</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">177</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">          return res.status(500).send(<i class=\"cond-miss\">err.message</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">178</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">179</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          // Documents can only be deleted by Admin or Owner</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">180</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">          Role.findById(req.decoded._doc.roleId, function(err, role) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">181</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            if (err)</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">182</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">183</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">            roles = role.title;</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">184</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            if (roles === 'Admin' || doc.ownerId === req.decoded._doc._id) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">185</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">              Document.remove({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">186</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                _id: req.params.document_id</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">187</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              }, function(err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">188</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                if (err)</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">189</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">190</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">                return res.status(200).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">191</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  'message': 'Document has been deleted'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">192</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">193</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">194</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">195</td>\n              <td class=\"hits\">1</td>\n              <td class=\"source\">              return res.status(403).json({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">196</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                'message': 'You need to be Owner or Admin to delete this Document'</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">197</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">198</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">199</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">200</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">201</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">202</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    },</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">203</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">204</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    update: function(req, res) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">205</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">      Document.findById(req.params.document_id, function(err, doc) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">206</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">207</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">          return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">208</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">209</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          // Users can only edit documents available to their role or they are the owner</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">210</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          if(req.body.title && req.body.content) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">211</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">            doc.title = req.body.title;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">212</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">            doc.content = req.body.content;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">213</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">            doc.save(function(err, savedDoc) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">214</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              if (err) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">215</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">216</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"hit\">\n              <td class=\"line\">217</td>\n              <td class=\"hits\">2</td>\n              <td class=\"source\">                return res.status(200).json(savedDoc);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">218</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">219</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            });</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">220</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          } else if (<i class=\"cond-miss\"><i class=\"cond-miss\"><i class=\"cond-miss\">req.body.title</i> && <i class=\"cond-miss\">req.body.content</i></i> && <i class=\"cond-miss\">req.body.access</i></i>) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">221</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">            Role.find({</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">222</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              title: req.body.access</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">223</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            }).exec(function(err, access) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">224</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              if (<i class=\"cond-miss\">err</i>) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">225</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                res.status(500).send(<i class=\"cond-miss\">err.errormessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">226</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">227</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                doc.accessId = access[0]._id;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">228</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                doc.title = req.body.title;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">229</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                doc.content = req.body.content;</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">230</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                doc.save(function(err, savedDoc) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">231</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  if (<i class=\"cond-miss\">err</i>) {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss-branch\">\n              <td class=\"line\">232</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                    return res.status(500).send(<i class=\"cond-miss\">err.errmessage</i> || <i class=\"cond-miss\">err</i>);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">233</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  } else {</td>\n            </tr>\n        \n      \n        \n        \n            <tr class=\"miss\">\n              <td class=\"line\">234</td>\n              <td class=\"hits\">0</td>\n              <td class=\"source\">                    return res.status(200).json(savedDoc);</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">235</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                  }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">236</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">                });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">237</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">              }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">238</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">            });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">239</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">          }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">240</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">        }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">241</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">      });</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">242</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">    }</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">243</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">  };</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">244</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\">})();</td>\n            </tr>\n        \n      \n        \n        \n            <tr>\n              <td class=\"line\">245</td>\n              <td class=\"hits\"></td>\n              <td class=\"source\"></td>\n            </tr>\n        \n      \n    </tbody>\n  </table>\n</div>");